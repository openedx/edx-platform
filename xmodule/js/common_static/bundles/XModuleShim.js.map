{"version":3,"sources":["webpack:///./common/lib/xmodule/xmodule/js/src/xmodule.js?5cf4"],"names":["XModule","Descriptor","element","update","_","bind","prototype","onUpdate","callback","callbacks","push","data","i","length","save","$","each","index","XBlockToXModuleShim","runtime","initArgs","moduleType","module","window","hasClass","document","trigger","error","console","message","call","exports"],"mappings":";;;;;AAAA;AACC,aAAW;;AAEZ,KAAC,YAAW;AACR;;AAEA,YAAIA,UAAU,EAAd;;AAEAA,gBAAQC,UAAR,GAAsB,YAAW;AAC7B;;;;;;;AAOA,gBAAIA,aAAa,SAAbA,UAAa,CAASC,OAAT,EAAkB;AAC/B,qBAAKA,OAAL,GAAeA,OAAf;AACA,qBAAKC,MAAL,GAAcC,EAAEC,IAAF,CAAO,KAAKF,MAAZ,EAAoB,IAApB,CAAd;AACH,aAHD;;AAKA;;;;;AAKAF,uBAAWK,SAAX,CAAqBC,QAArB,GAAgC,UAASC,QAAT,EAAmB;AAC/C,oBAAI,CAAC,KAAKC,SAAV,EAAqB;AACjB,yBAAKA,SAAL,GAAiB,EAAjB;AACH;;AAED,qBAAKA,SAAL,CAAeC,IAAf,CAAoBF,QAApB;AACH,aAND;;AAQA;;;AAGAP,uBAAWK,SAAX,CAAqBH,MAArB,GAA8B,YAAW;AACrC,oBAAIQ,IAAJ,EAAUF,SAAV,EAAqBG,CAArB,EAAwBC,MAAxB;;AAEAF,uBAAO,KAAKG,IAAL,EAAP;AACAL,4BAAY,KAAKA,SAAjB;AACAI,yBAASJ,UAAUI,MAAnB;;AAEAE,kBAAEC,IAAF,CAAOP,SAAP,EAAkB,UAASQ,KAAT,EAAgBT,QAAhB,EAA0B;AACxCA,6BAASG,IAAT;AACH,iBAFD;AAGH,aAVD;;AAYA;;;;;;;AAOAV,uBAAWK,SAAX,CAAqBQ,IAArB,GAA4B,YAAW;AACnC,uBAAO,EAAP;AACH,aAFD;;AAIA,mBAAOb,UAAP;AACH,SArDqB,EAAtB;;AAuDA,aAAKiB,mBAAL,GAA2B,UAASC,OAAT,EAAkBjB,OAAlB,EAA2BkB,QAA3B,EAAqC;AAC5D;;;;;AAKA,gBAAIC,UAAJ,EAAgBC,MAAhB;;AAEA,gBAAIF,QAAJ,EAAc;AACVC,6BAAaD,SAAS,cAAT,CAAb;AACH;AACD,gBAAI,CAACC,UAAL,EAAiB;AACbA,6BAAaN,EAAEb,OAAF,EAAWS,IAAX,CAAgB,MAAhB,CAAb;AACH;;AAED,gBAAIU,eAAe,MAAnB,EAA2B;AACvB;AACH;;AAED,gBAAI;AACAC,yBAAS,IAAIC,OAAOF,UAAP,CAAJ,CAAuBnB,OAAvB,EAAgCiB,OAAhC,CAAT;;AAEA,oBAAIJ,EAAEb,OAAF,EAAWsB,QAAX,CAAoB,cAApB,CAAJ,EAAyC;AACrCT,sBAAEU,QAAF,EAAYC,OAAZ,CAAoB,qBAApB,EAA2C,CAACxB,OAAD,EAAUoB,MAAV,CAA3C;AACH;;AAED,oBAAIP,EAAEb,OAAF,EAAWsB,QAAX,CAAoB,iBAApB,CAAJ,EAA4C;AACxCT,sBAAEU,QAAF,EAAYC,OAAZ,CAAoB,wBAApB,EAA8C,CAACxB,OAAD,EAAUoB,MAAV,CAA9C;AACH;;AAED,uBAAOA,MAAP;AACH,aAZD,CAYE,OAAOK,KAAP,EAAc;AACZC,wBAAQD,KAAR,CAAc,oBAAoBN,UAApB,GAAiC,IAAjC,GAAwCM,MAAME,OAA5D;AACH;AACJ,SAlCD;;AAoCA;AACA;AACA;AACA;AACA;AACA,aAAK7B,OAAL,GAAeA,OAAf;AACH,KAtGD,EAsGG8B,IAtGH,CAsGQ,IAtGR;AAwGC,CA1GA,EA0GCA,IA1GD,CA0GMP,MA1GN,CAAD;;AA4GA;AACAD,OAAOS,OAAP,GAAiBR,OAAOvB,OAAxB,C","file":"XModuleShim.js","sourcesContent":["/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n(function() {\n    'use strict';\n\n    var XModule = {};\n\n    XModule.Descriptor = (function() {\n        /*\n         * Bind the module to an element. This may be called multiple times,\n         * if the element content has changed and so the module needs to be rebound\n         *\n         * @method: constructor\n         * @param {html element} the .xmodule_edit section containing all of the descriptor content\n         */\n        var Descriptor = function(element) {\n            this.element = element;\n            this.update = _.bind(this.update, this);\n        };\n\n        /*\n         * Register a callback method to be called when the state of this\n         * descriptor is updated. The callback will be passed the results\n         * of calling the save method on this descriptor.\n         */\n        Descriptor.prototype.onUpdate = function(callback) {\n            if (!this.callbacks) {\n                this.callbacks = [];\n            }\n\n            this.callbacks.push(callback);\n        };\n\n        /*\n         * Notify registered callbacks that the state of this descriptor has changed\n         */\n        Descriptor.prototype.update = function() {\n            var data, callbacks, i, length;\n\n            data = this.save();\n            callbacks = this.callbacks;\n            length = callbacks.length;\n\n            $.each(callbacks, function(index, callback) {\n                callback(data);\n            });\n        };\n\n        /*\n         * Return the current state of the descriptor (to be written to the module store)\n         *\n         * @method: save\n         * @returns {object} An object containing children and data attributes (both optional).\n         *                   The contents of the attributes will be saved to the server\n         */\n        Descriptor.prototype.save = function() {\n            return {};\n        };\n\n        return Descriptor;\n    }());\n\n    this.XBlockToXModuleShim = function(runtime, element, initArgs) {\n        /*\n         * Load a single module (either an edit module or a display module)\n         * from the supplied element, which should have a data-type attribute\n         * specifying the class to load\n         */\n        var moduleType, module;\n\n        if (initArgs) {\n            moduleType = initArgs['xmodule-type'];\n        }\n        if (!moduleType) {\n            moduleType = $(element).data('type');\n        }\n\n        if (moduleType === 'None') {\n            return;\n        }\n\n        try {\n            module = new window[moduleType](element, runtime);\n\n            if ($(element).hasClass('xmodule_edit')) {\n                $(document).trigger('XModule.loaded.edit', [element, module]);\n            }\n\n            if ($(element).hasClass('xmodule_display')) {\n                $(document).trigger('XModule.loaded.display', [element, module]);\n            }\n\n            return module;\n        } catch (error) {\n            console.error('Unable to load ' + moduleType + ': ' + error.message);\n        }\n    };\n\n    // Export this module. We do it at the end when everything is ready\n    // because some RequireJS scripts require this module. If\n    // `window.XModule` appears as defined before this file has a chance\n    // to execute fully, then there is a chance that RequireJS will execute\n    // some script prematurely.\n    this.XModule = XModule;\n}).call(this);\n\n}.call(window));\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = window.XModule;\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/xmodule.js"],"sourceRoot":""}