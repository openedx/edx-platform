<%page expression_filter="h"/>

<%!
from django.urls import reverse
from django.utils.translation import ugettext as _
from openedx.core.djangolib.js_utils import js_escaped_string
from openedx.core.djangolib.markup import HTML, Text
%>

<script type="text/javascript">
    $(document).ready(function() {
        $('#send_cta_email').click(function(e) {
            $.ajax({
                type: 'POST',
                url: "${reverse('send_account_activation_email') | n, js_escaped_string}",
                data: $(this).serializeArray(),
                success: function() {
                    setTimeout(
                    function(){
                        $('#activate-account-modal p svg').remove();
                        // xss-lint: disable=javascript-jquery-append
                        $('#activate-account-modal p').append(
                        // xss-lint: disable=javascript-concat-html
                        '<svg  style="vertical-align:bottom" width="20" height="20"' +
                        // xss-lint: disable=javascript-concat-html
                        'viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n' +
                        // xss-lint: disable=javascript-concat-html
                        '<path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#178253"/>\n' +
                        '</svg>'
                        );
                    }, 500); // adding timeout to make spinner animation longer
                }
            });
            e.preventDefault();
            $('#activate-account-modal p svg').remove();
            // xss-lint: disable=javascript-jquery-append
            $('#activate-account-modal p').append(
            // xss-lint: disable=javascript-concat-html
            '<svg  class="fa-pulse" style="vertical-align:bottom" width="20" height="20"' +
            // xss-lint: disable=javascript-concat-html
            'viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n' +
            // xss-lint: disable=javascript-concat-html
            '<path d="M22 12A10 10 0 116.122 3.91l1.176 1.618A8 8 0 1020 12h2z" fill="#6c757d"/>\n' +
            '</svg>'
            );
        });

        $('#activate-account-modal').on('click', '#button', function() {
            $('#activate-account-modal').css('display', 'none');
            $('#lean_overlay').css({display: 'none'});
        });
        if ($('#activate-account-modal').css('display') === 'block') {
            $('#lean_overlay').css({
                display: 'block',
                'z-index': 0
            });
            $('#activate-account-modal').focus()
        }
    });
</script>

<div id="activate-account-modal" class="modal activate-account-modal" aria-hidden="true" tabindex=0 >
    <div class="inner-wrapper" role="dialog" aria-labelledby="activate-account-modal-title" aria-live="polite">
        <h3 class="activate-account-modal-title">
            ${_("Activate your account so you can log back in")}
            <span class="sr">,
            ## Translators: this text gives status on if the modal interface (a menu or piece of UI that takes the full focus of the screen) is open or not
            ${_("window open")}
            </span>
        </h3>
        <p class="activate-account-modal-body">${Text(_("We sent an email to {strong_start}{email}{strong_end} with a link to activate your account. Canâ€™t find it? Check your spam folder or {link_start}resend the email{link_end}.")).format(
            strong_start=HTML('<strong>'),
            email=user.email,
            strong_end=HTML('</strong>'),
            link_start=HTML('<a href="#" id="send_cta_email" >'),
            link_end=HTML('</a>')
            )}
        </p>
        <div class="activate-account-modal-button">
            <button class="btn btn-primary" id="button">
                ${Text(_("Continue to {platform_name}")).format(platform_name=settings.PLATFORM_NAME)}
                <svg  style="vertical-align:bottom" width="24" height="24" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/></svg>
            </button>
        </div>

    </div>
</div>
