<%! from django.utils.translation import ugettext as _ %>
<%! from django_comment_client.helpers import pluralize %>
<%! from django_comment_client.permissions import has_permission, check_permissions_by_view %>
<%! from operator import attrgetter %>
<%! from django.utils.translation import ungettext%>


<div class="user-profile">
  <%
    role_names = sorted(set(map(attrgetter('name'), django_user.roles.all())))
  %>
  <div class="sidebar-username">${django_user.profile.firstname + ' ' + django_user.profile.lastname | h}</div>
  <div class="sidebar-user-roles">
    ${", ".join([ _(x) for x in role_names])}
  </div>
  <div class="sidebar-threads-count"><span>${profiled_user['threads_count'] | h}</span> ${ungettext('discussion started', 'discussions started', profiled_user['threads_count']) | h}</div>
  <div class="sidebar-comments-count"><span>${profiled_user['comments_count'] | h}</span> ${ungettext('comment', 'comments', profiled_user['comments_count']) | h}</div>
  % if check_permissions_by_view(user, course.id, content=None, name='update_moderator_status'):
    % if "Moderator" in role_names:
      <a href="javascript:void(0)" class="sidebar-toggle-moderator-button sidebar-revoke-moderator-button">${_("Revoke Moderator rights")}</a>
    % else:
      <a href="javascript:void(0)" class="sidebar-toggle-moderator-button sidebar-promote-moderator-button">${_("Promote to Moderator")}</a>
    % endif
  % endif
</div>
