{% load static i18n %}

<section class="discussion discussion-board page-content-container"
         id="discussion-container"
         data-course-id="{{ course.id }}"
         data-user-create-comment="{{ can_create_comment|yesno:'true,false' }}"
         data-user-create-subcomment="{{ can_create_subcomment|yesno:'true,false' }}"
         data-read-only="false"
         data-sort-preference="{{ sort_preference }}"
         data-flag-moderator="{{ flag_moderator|yesno:'true,false' }}"
         data-user-group-id="{{ user_group_id }}">

    <header class="page-header has-secondary">

        {# Breadcrumb navigation #}
        <div class="page-header-main">
            <nav aria-label="{% trans 'Discussions' as tmsg%} {{tmsg|force_escape}}"
                 class="sr-is-focusable"
                 tabindex="-1">
                <div class="has-breadcrumbs"></div>
            </nav>
        </div>

        <div class="page-header-secondary">

            {# Add Post button #}             
            {% if can_create_thread %}
            <div class="forum-actions">
                <button class="btn btn-outline-primary btn-small new-post-btn">
                    {% trans "Add a Post" as tmsg%} {{tmsg|force_escape}}
                </button>
            </div>
            {% endif %}

           {# Search box #}
            <div class="forum-search"></div>
        </div>
    </header>

    {% if course_expiration_fragment %}
        {{ course_expiration_fragment.content|safe }}
    {% endif %}

    <div class="page-content"
         {% if course.language %}
             lang="{{ course.language }}"
         {% endif %}
    >
        <div class="discussion-body">

            <main id="main"
                  class="discussion-column"
                  aria-label="Content"
                  tabindex="-1">

                <article class="new-post-article is-hidden"
                         style="display: none"
                         tabindex="-1"
                         aria-label="{% trans 'New topic form' as tmsg%} {{tmsg|force_escape}}">
                </article>

                <div class="forum-content"></div>
            </main>

            <aside class="forum-nav"
                   role="complementary"
                   aria-label="{% trans 'Discussion thread list' as tmsg%} {{tmsg|force_escape}}">

                {% include "discussion/_filter_dropdown.html" %}
                <div class="discussion-thread-list-container"></div>

            </aside>
        </div>
    </div>
</section>

{% include "discussion/_underscore_templates.html" %}
{% include "discussion/_thread_list_template.html" %}

<script>
require(["js/commerce/track_ecommerce_events"], function (TrackECommerceEvents) {

    var fbeLink = $("#FBE_banner");

    TrackECommerceEvents.trackUpsellClick(
        fbeLink,
        'discussion_audit_access_expires',
        {
            pageName: "discussion_tab",
            linkType: "link",
            linkCategory: "FBE_banner"
        }
    );
});
</script>
